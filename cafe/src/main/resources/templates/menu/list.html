<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<head>
    <meta charset="UTF-8">
    <title>Danh sách món</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800">
<div layout:fragment="content" class="max-w-6xl mx-auto mt-10 bg-white p-6 rounded shadow">

    <h2 class="text-2xl font-bold text-blue-600 mb-6">📋 Danh sách thực đơn</h2>

    <!-- Search Form -->
    <form method="get" th:action="@{/menu}" class="mb-6 flex gap-2 flex-wrap">
        <input type="text" name="keyword" placeholder="Tìm kiếm..." th:value="${keyword}"
               class="border rounded px-3 py-2 flex-1 min-w-[200px]" />
        <button type="submit"
                class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded">
            🔍 Tìm
        </button>
        <a th:href="@{/menu/add}"
           class="ml-auto bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded">
            ➕ Thêm món mới
        </a>
    </form>

    <!-- Table desktop -->
    <div class="hidden sm:block overflow-x-auto">
        <table class="min-w-full bg-white border border-gray-300">
            <thead class="bg-gray-200">
            <tr>
                <th class="py-2 px-4 border text-left">STT</th>
                <th class="py-2 px-4 border text-left">Tên món</th>
                <th class="py-2 px-4 border text-right">Giá tiền</th>
                <th class="py-2 px-4 border text-center">Hành động</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="item, iterStat : ${menuPage.content}" class="hover:bg-gray-50">
                <td class="py-2 px-4 border" th:text="${iterStat.index + 1}"></td>
                <td class="py-2 px-4 border" th:text="${item.itemName}"></td>
                <td class="py-2 px-4 border text-right"
                    th:text="${#numbers.formatDecimal(item.currentPrice, 0, 'COMMA', 0, 'POINT') + ' đ'}"></td>
                <td class="py-2 px-4 border text-center">
                    <a th:href="@{'/menu/edit/' + ${item.id}}"
                       class="text-blue-600 hover:underline mr-3">✏️ Sửa</a>
                    <form th:action="@{'/menu/delete/' + ${item.id}}" method="post" class="inline"
                          onsubmit="return confirm('Bạn chắc chắn muốn xóa?')">
                        <button type="submit" class="text-red-600 hover:underline">🗑️ Xóa</button>
                    </form>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

    <!-- Mobile cards -->
    <div class="grid grid-cols-1 gap-4 sm:hidden mt-4">
        <div th:each="item : ${menuPage.content}" class="bg-white border border-gray-300 rounded-lg p-4 shadow hover:shadow-md transition">
            <div class="flex justify-between items-center">
                <h3 class="text-lg font-semibold" th:text="${item.itemName}">Tên món</h3>
                <span class="text-blue-600 font-semibold text-sm"
                      th:text="${#numbers.formatDecimal(item.currentPrice, 0, 'COMMA', 0, 'POINT') + ' đ'}">0 đ</span>
            </div>
            <div class="mt-3 flex justify-end gap-3">
                <a th:href="@{'/menu/edit/' + ${item.id}}"
                   class="text-sm bg-yellow-400 hover:bg-yellow-500 text-white px-3 py-1.5 rounded">✏️ Sửa</a>
                <form th:action="@{'/menu/delete/' + ${item.id}}" method="post"
                      onsubmit="return confirm('Bạn chắc chắn muốn xóa?')">
                    <button type="submit"
                            class="text-sm bg-red-500 hover:bg-red-600 text-white px-3 py-1.5 rounded">🗑️ Xóa
                    </button>
                </form>
            </div>
        </div>
        <div th:if="${#lists.isEmpty(menuPage.content)}" class="col-span-full text-center text-gray-500 italic py-6 bg-white rounded shadow">
            Không có món nào được tìm thấy.
        </div>
    </div>

    <!-- Pagination -->
    <div th:if="${menuPage.totalPages > 1}" class="mt-6 flex gap-2 flex-wrap">
        <a th:each="i : ${#numbers.sequence(0, menuPage.totalPages - 1)}"
           th:href="@{/menu(page=${i}, keyword=${keyword})}" th:text="${i + 1}"
           th:classappend="${menuPage.number == i} ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-800 hover:bg-gray-300'"
           class="px-3 py-1 rounded border text-sm"></a>
    </div>

</div>
</body>
</html>
