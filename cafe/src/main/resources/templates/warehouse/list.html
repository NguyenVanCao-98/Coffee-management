<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<head>
  <meta charset="UTF-8">
  <title>Danh s√°ch h√†ng h√≥a</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800">
<div layout:fragment="content" class="max-w-7xl mx-auto px-4 py-6 w-full">

  <h2 class="text-2xl font-bold mb-6">üì¶ Danh s√°ch h√†ng h√≥a</h2>

  <!-- T√¨m ki·∫øm + N√∫t l·ªãch s·ª≠ -->
 <div class="flex flex-wrap items-center justify-between mb-6 gap-4">
    <form th:action="@{/warehouse/search}" method="get" class="flex flex-1 max-w-md">
        <input type="text" name="keyword" placeholder="T√¨m ki·∫øm h√†ng h√≥a..."
               th:value="${keyword}" 
               class="flex-1 px-4 py-2 border border-gray-300 rounded-l" />
        <button type="submit"
                class="px-4 py-2 bg-blue-600 text-white rounded-r hover:bg-blue-700">
            T√¨m ki·∫øm
        </button>
    </form>

    <div class="flex flex-1 space-x-2">
        <a th:href="@{/warehouse/history/import}" 
           class="flex-1 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 text-center">
            L·ªãch s·ª≠ nh·∫≠p
        </a>
        <a th:href="@{/warehouse/history/export}" 
           class="flex-1 px-4 py-2 bg-orange-500 text-white rounded hover:bg-orange-600 text-center">
            L·ªãch s·ª≠ xu·∫•t
        </a>
    </div>
</div>


  <!-- Desktop view -->
  <div class="overflow-x-auto hidden sm:block" th:if="${!#lists.isEmpty(productPage.content)}">
    <table class="min-w-full bg-white border border-gray-200 rounded shadow">
      <thead class="bg-gray-200">
        <tr>
          <th class="px-4 py-2 text-left">T√™n</th>
          <th class="px-4 py-2 text-left">Ng√†y nh·∫≠p</th>
          <th class="px-4 py-2 text-left">Ng√†y xu·∫•t</th>
          <th class="px-4 py-2 text-left">S·ªë l∆∞·ª£ng</th>
          <th class="px-4 py-2 text-left">ƒê∆°n v·ªã</th>
          <th class="px-4 py-2 text-left">ƒê∆°n gi√°</th>
          <th class="px-4 py-2 text-left">T·ªïng ti·ªÅn</th>
          <th class="px-4 py-2 text-left">H√†nh ƒë·ªông</th>
        </tr>
      </thead>
      <tbody>
        <tr th:each="product : ${productPage.content}" class="border-t hover:bg-gray-50">
          <td class="px-4 py-2" th:text="${product.productName}">T√™n s·∫£n ph·∫©m</td>
          <td class="px-4 py-2" th:text="${product.lastImportDate != null ? #temporals.format(product.lastImportDate, 'dd/MM/yyyy') : '-'}">-</td>
          <td class="px-4 py-2" th:text="${product.lastExportDate != null ? #temporals.format(product.lastExportDate, 'dd/MM/yyyy') : '-'}">-</td>
          <td class="px-4 py-2" th:text="${product.currentQuantity}">0</td>
          <td class="px-4 py-2" th:text="${product.unitName}">ƒê∆°n v·ªã</td>
          <td class="px-4 py-2" th:text="${product.latestPrice != null ? #numbers.formatDecimal(product.latestPrice, 1, 'COMMA', 0, 'POINT') : '0'}">0</td>
          <td class="px-4 py-2" th:text="${product.totalAmount != null ? #numbers.formatDecimal(product.totalAmount, 1, 'COMMA', 0, 'POINT') : '0'}">0</td>
          <td class="px-4 py-2 space-y-1">
            <a th:href="@{'/warehouse/edit/' + ${product.id}}" class="text-blue-600 hover:underline block">S·ª≠a</a>
           <a th:href="@{/warehouse/delete/{id}(id=${product.id}, page=${productPage.number})}"
			   onclick="return confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a kh√¥ng?')"
			   class="text-red-600 hover:underline block">X√≥a</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Mobile view -->
  <div class="grid grid-cols-1 gap-4 sm:hidden" th:if="${!#lists.isEmpty(productPage.content)}">
    <div th:each="product : ${productPage.content}" 
         class="bg-white p-4 border rounded shadow hover:shadow-md transition">
      <p class="text-lg font-semibold text-gray-800" th:text="${product.productName}">T√™n s·∫£n ph·∫©m</p>
      <p class="text-sm text-gray-500 mt-1">üì• Ng√†y nh·∫≠p: 
        <span th:text="${product.lastImportDate != null ? #temporals.format(product.lastImportDate, 'dd/MM/yyyy') : '-'}"></span>
      </p>
      <p class="text-sm text-gray-500">üì§ Ng√†y xu·∫•t: 
        <span th:text="${product.lastExportDate != null ? #temporals.format(product.lastExportDate, 'dd/MM/yyyy') : '-'}"></span>
      </p>
      <p class="text-sm text-gray-600">üì¶ S·ªë l∆∞·ª£ng: 
        <span class="font-medium" th:text="${product.currentQuantity}"></span> 
        <span th:text="${product.unitName}"></span>
      </p>
      <p class="text-sm text-gray-600">üí∞ ƒê∆°n gi√°: 
        <span class="font-medium" th:text="${product.latestPrice != null ? #numbers.formatDecimal(product.latestPrice, 1, 'COMMA', 0, 'POINT') : '0'}"></span>
      </p>
      <p class="text-sm text-gray-600">üíµ T·ªïng ti·ªÅn: 
        <span class="font-medium" th:text="${product.totalAmount != null ? #numbers.formatDecimal(product.totalAmount, 1, 'COMMA', 0, 'POINT') : '0'}"></span>
      </p>
      <div class="flex gap-3 mt-3">
        <a th:href="@{'/warehouse/edit/' + ${product.id}}" class="text-blue-600 hover:underline">‚úèÔ∏è S·ª≠a</a>
     <a th:href="@{/warehouse/delete/{id}(id=${product.id}, page=${productPage.number})}"
		   onclick="return confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a kh√¥ng?')"
		   class="text-red-600 hover:underline">X√≥a</a>
      </div>
    </div>
  </div>

  <!-- Th√¥ng b√°o khi kh√¥ng c√≥ d·ªØ li·ªáu -->
  <div th:if="${#lists.isEmpty(productPage.content)}"
       class="col-span-full text-center text-gray-500 italic py-6 bg-white rounded shadow">
    Kh√¥ng c√≥ d·ªØ li·ªáu
  </div>

  <!-- Ph√¢n trang -->
  <div class="mt-6 flex items-center justify-between w-full">
    <span class="text-sm"
          th:text="'Trang ' + (${productPage.totalPages > 0 ? productPage.number + 1 : 1})
                    + ' / ' + (${productPage.totalPages > 0 ? productPage.totalPages : 1})">
      Trang 1 / 1
    </span>

    <div class="flex items-center space-x-1" th:if="${productPage.totalPages > 0}">
      <!-- N√∫t tr∆∞·ªõc -->
      <a th:if="${!productPage.first}"
         th:href="@{/warehouse(page=${productPage.number - 1}, size=${productPage.size})}"
         class="px-3 py-1 bg-gray-300 rounded hover:bg-gray-400">¬´ Tr∆∞·ªõc</a>

      <!-- C√°c trang -->
      <span th:each="i : ${#numbers.sequence(0, productPage.totalPages - 1)}">
        <span th:if="${productPage.number == i}"
              th:text="${i + 1}"
              class="px-3 py-1 rounded bg-blue-600 text-white"></span>
        <a th:if="${productPage.number != i}"
           th:href="@{/warehouse(page=${i}, size=${productPage.size})}"
           th:text="${i + 1}"
           class="px-3 py-1 rounded bg-gray-200 hover:bg-gray-300"></a>
      </span>

      <!-- N√∫t sau -->
      <a th:if="${!productPage.last}"
         th:href="@{/warehouse(page=${productPage.number + 1}, size=${productPage.size})}"
         class="px-3 py-1 bg-gray-300 rounded hover:bg-gray-400">Sau ¬ª</a>
    </div>
  </div>
</div>
</body>
</html>
