<!-- ƒê√¢y l√† result.html, hi·ªÉn th·ªã k·∫øt qu·∫£ thanh to√°n cu·ªëi c√πng bao g·ªìm t·ªïng ti·ªÅn, gi·∫£m gi√° v√† ti·ªÅn nh·∫≠n -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<head>
    <meta charset="UTF-8">
    <title>K·∫øt qu·∫£ thanh to√°n</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800">

<div layout:fragment="content" class="max-w-2xl mx-auto bg-white p-6 rounded-lg shadow mt-10">

    <h2 class="text-2xl font-bold text-blue-700 mb-6">üìÑ K·∫øt qu·∫£ thanh to√°n</h2> 

    <!-- ‚úÖ Hi·ªÉn th·ªã khi thanh to√°n th√†nh c√¥ng -->
    <div th:if="${response.success}" class="bg-green-50 border-l-4 border-green-500 text-green-700 p-4 rounded mb-6">
        <p class="font-semibold text-lg mb-2">‚úÖ Thanh to√°n th√†nh c√¥ng!</p> <!-- Th√¥ng b√°o th√†nh c√¥ng -->

        <ul class="space-y-1 pl-4 list-disc"> <!-- Danh s√°ch th√¥ng tin -->
            <li><b>T·ªïng ti·ªÅn:</b>
                <!-- Hi·ªÉn th·ªã t·ªïng s·ªë ti·ªÅn, ƒë·ªãnh d·∫°ng s·ªë -->
                <span th:text="${#numbers.formatDecimal(response.totalAmount, 0, 'COMMA', 0, 'POINT')} + ' VND'">0 VND</span>
            </li>
            <li><b>Kh√°ch ƒë∆∞a:</b>
                <!-- Hi·ªÉn th·ªã s·ªë ti·ªÅn kh√°ch ƒë∆∞a -->
                <span th:text="${#numbers.formatDecimal(response.customerCash, 0, 'COMMA', 0, 'POINT')} + ' VND'">0 VND</span>
            </li>
            <li><b>Ti·ªÅn th·ªëi l·∫°i:</b>
                <!-- Hi·ªÉn th·ªã s·ªë ti·ªÅn tr·∫£ l·∫°i cho kh√°ch -->
                <span th:text="${#numbers.formatDecimal(response.change, 0, 'COMMA', 0, 'POINT')} + ' VND'">0 VND</span>
            </li>
            <li><b>H√≥a ƒë∆°n ID:</b>
                <!-- Hi·ªÉn th·ªã m√£ h√≥a ƒë∆°n -->
                <span th:text="${response.invoiceId}">---</span>
            </li>
            <li><b>Tr·∫°ng th√°i h√≥a ƒë∆°n:</b>
                <!-- Hi·ªÉn th·ªã tr·∫°ng th√°i: ƒê√£ thanh to√°n / Ch∆∞a thanh to√°n -->
                <span th:text="${response.invoiceStatus}">---</span>
            </li>
            <li><b>Nh√¢n vi√™n thanh to√°n:</b>
                <!-- Hi·ªÉn th·ªã t√™n nh√¢n vi√™n th·ª±c hi·ªán thanh to√°n -->
                <span th:text="${response.paidByName}">Kh√¥ng r√µ</span>
                (ID: <span th:text="${response.paidById}">-</span>) <!-- M√£ nh√¢n vi√™n -->
            </li>
        </ul>
    </div>

    <!-- ‚ùå Hi·ªÉn th·ªã khi thanh to√°n th·∫•t b·∫°i -->
    <div th:if="${!response.success}" class="bg-red-50 border-l-4 border-red-500 text-red-700 p-4 rounded mb-6">
        <p class="font-semibold text-lg mb-2">‚ùå Thanh to√°n th·∫•t b·∫°i</p> <!-- Ti√™u ƒë·ªÅ l·ªói -->
        <p><b th:text="${response.message}">L·ªói kh√¥ng x√°c ƒë·ªãnh</b></p> <!-- Th√¥ng b√°o l·ªói -->
    </div>

    <!-- N√∫t quay l·∫°i m√†n h√¨nh danh s√°ch b√†n -->
    <a href="/sale"
       class="inline-block mt-4 text-blue-600 hover:text-blue-800 hover:underline transition">
        ‚Üê Quay l·∫°i danh s√°ch b√†n
    </a>

    <!-- N√∫t in h√≥a ƒë∆°n, ch·ªâ hi·ªán khi thanh to√°n th√†nh c√¥ng -->
    <!-- D·∫´n t·ªõi trang in h√≥a ƒë∆°n c·ªßa b√†n -->
    <!-- M·ªü trang in ·ªü tab m·ªõi -->
    <a th:if="${response.success}"
       th:href="@{'/sale/' + ${tableId} + '/print'}" 
       target="_blank" 
       id="print-button"
       class="inline-block mt-4 ml-6 text-green-600 hover:text-green-800 hover:underline transition">
        üñ® In h√≥a ƒë∆°n
    </a>

</div>

<!-- Script l·∫Øng nghe t√≠n hi·ªáu t·ª´ c·ª≠a s·ªï in g·ª≠i v·ªÅ -->
<script>
    window.addEventListener('message', function(event) {
        if (event.data === 'printed') {
            alert("üñ® ƒê√£ in h√≥a ƒë∆°n th√†nh c√¥ng!"); // Hi·ªÉn th·ªã th√¥ng b√°o sau khi in
        }
    });
</script>

</body>

</html>
